plot_image(1,1)
plot_image(1,2)
plot_image(1,3)
plot_image(1,4)
X11();par(mfrow=c(3,2)); for (i in 1:4) plot_image(1,i);plot_box(1)
exp=1;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=2;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=3;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=2;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=3;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=4;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=5;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=6;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=7;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=1;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=2;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=3;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
exp=4;par(mfrow=c(3,2)); for (i in 1:4) plot_image(exp,i);plot_box(exp)
plot_trace_average(4,4)
plot_trace_average(4,1)
plot_trace_average(4,2)
plot_image(4,2)
plot_trace_average(4,2)
plot_dp()
source("precluster_analysis_barrage1_pulled.R")
  location_max3<-vector("list",length(prefix_list));
epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
cenfile
 for (i in 1:length(prefix_list)){
        location_max3[[i]]<-table(factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3]))
}
location_max3
boxplot(location_max3)
factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
rm(list=ls())
source("precluster_analysis_barrage1_pulled.R")
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
for (i in 1:length(prefix_list)){
        location_max3[[i]]<-table(factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3]))
}
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
}
location_max3
location_max3
location_max3[[1]]
length(location_max3[[1]])
cenfile_list[[1]]
length(cenfile_list[[1]])
nrow(cenfile_list[[1]])
cenfile_list[[1]]
nrow(cenfile_list[[1]])
length(location_max3[[1]])
location_max3[[1]]
location_max3[[1]]=="WIGGLY3_DL"
location_max3[[1]]=="WIGGLY3_DL"
plot_image(location_max3[[1]]=="WIGGLY3_DL",1)
experiment
experiment=1
y=cenfile_list[[experiment]]$V1+1
    x=cenfile_list[[experiment]]$V2+1
    nx=dimvec_list[[experiment]][1]
    ny=dimvec_list[[experiment]][2]
image(1:nx,1:ny,matrix(avtab_list[[experiment]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
plot_image(location_max3[[1]]=="WIGGLY3_DL",1)
image(1:nx,1:ny,matrix(avtab_list[[experiment]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
location_max3[[1]]=="WIGGLY3_DL"
cell<-location_max3[[1]]=="WIGGLY3_DL"

 l<-outputRCT_list[[experiment]][,1]%in%(cell)
l
l<-location_max3[[1]]=="WIGGLY3_DL"
c=6
pch=19
S=1.5
 points(x[l],y[l],col=martincolorscale[c],pch=P,cex=S)
P=19
 points(x[l],y[l],col=martincolorscale[c],pch=P,cex=S)
location_max3[[1]]=="WIGGLY3_UL"
l<-location_max3[[1]]=="WIGGLY3_UL"
 points(x[l],y[l],col=martincolorscale[c],pch=P,cex=S)
 points(x[l],y[l],col=martincolorscale[1],pch=P,cex=S)
l<-location_max3[[1]]=="WIGGLY3_UR"
 points(x[l],y[l],col=martincolorscale[2],pch=P,cex=S)
l<-location_max3[[1]]=="WIGGLY3_DR"
 points(x[l],y[l],col=martincolorscale[3],pch=P,cex=S)
 points(x[l],y[l],col=martincolorscale[4],pch=P,cex=S)
 points(x[l],y[l],col=martincolorscale[6],pch=P,cex=S)
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
epochs_W3
i
i=1
location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
location_max3
location_max3[[1]]
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max3[[i]]<-table(factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3]))
        location_max15[[i]]<-table(factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15]))
        location_max30[[i]]<-table(factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30]))
        }
location_max3
  location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
#       location_max3[[i]]<-table(factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3]))
        location_max15[[i]]<-table(factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15]))
        location_max30[[i]]<-table(factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30]))
        }
location_max3
 location_max3<-t(sapply(table(location_max3),unlist));
location_max3<-t(sapply(location_max3,function unlist((table(x))));
location_max3<-t(sapply(location_max3,function unlist((table(x))))
location_max3<-t(sapply(location_max3,function unlist(table(x)))
location_max3<-t(sapply(location_max3, function(x) unlist(table(x)))
)
location_max3
    location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
}
location_max3[[1]]
outputRCT_list[,1][location_max3[[1]]=="WIGGLY3_DL"]
outputRCT_list[[1]][,1][location_max3[[1]]=="WIGGLY3_DL"]
X11()
X11()
i=1
 plot_image(outputRCT_list[[1]][,1][location_max3[[1]]=="WIGGLY3_DL"],i)
a<-outputRCT_list[[1]][,1][location_max3[[1]]=="WIGGLY3_DL"]
b<-outputRCT_list[[1]][,1][location_max3[[1]]=="WIGGLY3_DL"]
c(a,b)
c(1,2)
 quad<-("DL,UL,DR,UL")
quad
quad[1]
    quad<-("DL","UL","DR","UL") 
    quad<-c("DL","UL","DR","UL")
quad
quad[1]
DL3
location_max3
location_max3=="UL"
location_max3[[1]]=="UL"
lgrep("UL",location_max3[[1]])
grepl("UL",location_max3[[1]])
i=1
j=1
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UL")    
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
j
 max_cells[[j]]<-outputRCT_list[[i]][,1][grepl(quad[j],location_max3[[i]])]
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[experiment]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
max_cell
max_cells
i
 y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
y
   max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
X11()
 y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[experiment]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
X11()
    location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UL")    
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
    for (j in 1:length(quad)){  
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[experiment]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
    }
for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){  
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
    }
i
i=1
 location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){  
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
j
j=1
location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){  
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
source("precluster_analysis_barrage1_pulled.R")
source("precluster_analysis_barrage1_pulled.R")
source("precluster_analysis_barrage1_pulled.R")
i=1
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UL")
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
 location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UR")
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
    }
   location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UR")
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
    }
source("precluster_analysis_barrage1_pulled.R")
   location_max3<-vector("list",length(prefix_list));
    location_max15<-vector("list",length(prefix_list));
    location_max30<-vector("list",length(prefix_list));
    epochs_W3 <-grep(("WIGGLY3_"), epochs, value = F, invert=F);
    epochs_W15 <-grep(("WIGGLY15_"), epochs, value = F, invert=F);
    epochs_W30 <-grep(("WIGGLY30_"), epochs, value = F, invert=F);
    quad<-c("DL","UL","DR","UR")
    max_cells<-vector("list",length(quad))
    lmat=matrix(1:length(prefix_list),ncol=length(prefix_list)/2)
    layout(lmat); par(mar=c(.5,.5,.5,.5))
    for (i in 1:length(prefix_list)){
        location_max3[[i]]<-factor(epochs[epochs_W3[max.col(outputRCT_list[[i]][,epochs_W3+1])]],levels=epochs[epochs_W3])
        location_max15[[i]]<-factor(epochs[epochs_W15[max.col(outputRCT_list[[i]][,epochs_W15+1])]],levels=epochs[epochs_W15])
        location_max30[[i]]<-factor(epochs[epochs_W30[max.col(outputRCT_list[[i]][,epochs_W30+1])]],levels=epochs[epochs_W30])
        y=cenfile_list[[i]]$V1+1
        x=cenfile_list[[i]]$V2+1
        nx=dimvec_list[[i]][1]
        ny=dimvec_list[[i]][2]
        image(1:nx,1:ny,matrix(avtab_list[[i]]$V2,ncol=ny,nrow=nx),ylim=c(ny+0.5,0.5),col=gray.colors(100),xaxt='n',yaxt='n',ann=FALSE);
    for (j in 1:length(quad)){
        max_cells[[j]]<-grepl(quad[j],location_max3[[i]])
        points(x[max_cells[[j]]],y[max_cells[[j]]],col=martincolorscale[j],pch=P,cex=S)
        }
    }
X11();plot(1,1,col=martincolorscale[1])
X11();plot(1,1,col=martincolorscale[1],pch=18)
location_max()
source("precluster_analysis_barrage1_pulled.R")
location_max()
source("precluster_analysis_barrage1_pulled.R")
location_max()
location_max()
source("precluster_analysis_barrage1_pulled.R")
location_max()
source("precluster_analysis_barrage1_pulled.R")
location_max()
source("bar_dot_precluster_analysis_pulled.R")
SIN_param<-hist(dotS_SIN,plot=F)
SIN_param
sum(SIN_param$counts[SIN_param$mid>=0.5])
sum(SIN_param$counts[SIN_param$mid>=0.5])/sum(SIN_param$counts)
notSIN_param<-hist(dotS_notSIN,plot=F)
sum(notSIN_param$counts[notSIN_param$mid>=0.5])/sum(notSIN_param$counts)
notSIN_param
sum(notSIN_param$counts[notSIN_param$mid>=0.3])/sum(notSIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.3])/sum(SIN_param$counts)
SIN_param<-hist(dotS_SIN,plot=F,breaks=50)
SIN_param
notSIN_param<-hist(dotS_notSIN,plot=F,breaks=50)
notSIN_param
sum(notSIN_param$counts[notSIN_param$mid>=0.5])/sum(notSIN_param$counts)
sum(notSIN_param$counts[notSIN_param$mid>=0.45])/sum(notSIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.45])/sum(SIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.5])/sum(SIN_param$counts)
SIN_param<-hist(dotS_SIN,plot=F)
sum(SIN_param$counts[SIN_param$mid>=0.5])/sum(SIN_param$counts)
hist(dotS_notSIN)
sum(SIN_param$counts[SIN_param$mid>=0.33])/sum(SIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.5])/sum(SIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.9])/sum(SIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.7])/sum(SIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.5])/sum(SIN_param$counts)
sum(notSIN_param$counts[notSIN_param$mid>=0.5])/sum(notSIN_param$counts)
sum(notSIN_param$counts[notSIN_param$mid>=0.45])/sum(notSIN_param$counts)
sum(SIN_param$counts[SIN_param$mid>=0.45])/sum(SIN_param$counts)
SIN_dotS
dotS_SIN
dotS_SIN>0.5
sum(dotS_SIN>0.5)
sum(dotS_SIN>0.5)/length(dotS_SIN)
sum(dotS_notSIN>0.5)/length(dotS_notSIN)
sum(dotS_notSIN<(-0.5))/length(dotS_notSIN)
sum(dotS_SIN<(-0.5))/length(dotS_SIN)
source("DC2_PVN_pulled.R")
par(mfrow=c(2,2); for (i in 1:4) plot_image(1,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(1,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(2,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(3,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(4,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(5,i)
par(mfrow=c(2,2)); for (i in 1:4) plot_image(6,i)
plot_box(1)
source("DC2_PVN_pulled.R")
plot_analysis(4)
plot_analysis(1)
plot_analysis(4)
plot_trace_average(1,1)
plot_trace_average(1,2)
plot_trace_average(1,3)
plot_trace_average(1,4)
plot_ent_cluster(4)
plot_ent_cluster(4)
X11()
plot_ent_cluster(1)
plot_box(1)
plot_box_experiment(1)
plot_box_experiment(1,1)
source("DC2_PVN_pulled.R")
source("DC2_PVN_pulled.R")
plot_box(1)
plot_traj(1)
plot_traj(1)
source("DC2_PVN_pulled.R")
plot_box(!)
plot_box(1)
plot_box(2)
plot_box(3)
plot_box(4)
plot_box(5)
plot_box(1)
plot_cluster(1)
plot_cluster(1)
plot_cluster(1)
plot_cluster(1,T)
source("DC2_PVN_pulled.R")
plot_cluster(1,T)
source("DC2_PVN_pulled.R")
plot_dotS_cluster(4)
plot_dotS_cluster_box(4)
cluster=4
 index<-mapply(function(output,cells) output[,1] %in% cells, output_raw_list,cluster_cells_ID(cluster))
  index<-unlist(index)
  # dotS<-unlist(dotS_list)
  dotS_cluster<-do.call(rbind,dotS_list)[index,]
  dotScluster<-rowSums(dotS)/10
  dotS<-do.call(rbind,dotS_list)
  dotS<-rowSums(dotS)/10
 boxplot(dotS_cluster,ylim=c(-1,1),main="",col=martincolorscale[1],xlab="",at=-0.5,wex=0.5)
dotS_cluster
index<-mapply(function(output,cells) output[,1] %in% cells, output_raw_list,cluster_cells_ID(cluster))
  index<-unlist(index)
  # dotS<-unlist(dotS_list)
  dotS_cluster<-do.call(rbind,dotS_list)[index,]
  dotS_cluster<-rowSums(dotS)/10
  dotS<-do.call(rbind,dotS_list)
  dotS<-rowSums(dotS)/10
dotS_cluster
index
index<-mapply(function(output,cells) output[,1] %in% cells, output_raw_list,cluster_cells_ID(cluster))
  index<-unlist(index)
  # dotS<-unlist(dotS_list)
  dotS_cluster<-do.call(rbind,dotS_list)[index,]
dotS_Cl
dotS_cluster
dotS_cluster<-rowSums(dotS_cluster)/10
dotS_cluster
 index<-unlist(index)
  # dotS<-unlist(dotS_list)
  dotS_cluster<-do.call(rbind,dotS_list)[index,]
  dotS_cluster<-rowSums(dotS_cluster)/10
  dotS<-do.call(rbind,dotS_list)
  dotS<-rowSums(dotS)/10
  boxplot(dotS_cluster,ylim=c(-1,1),main="",col=martincolorscale[1],xlab="",at=-0.5,wex=0.5)
  boxplot(dotS,add=T,at=0.5,wex=0.5)
  boxplot(dotS_cluster,ylim=c(-1,1),main="",col=martincolorscale[1],xlab="",at=-0.5,wex=0.5)
  boxplot(dotS,add=T,at=-0.25,wex=0.5)
quit()
